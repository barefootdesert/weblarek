
# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Vite

## Структура проекта

-   **src/** — исходные файлы проекта
    
-   **src/components/** — папка с компонентами интерфейса (View)
    
-   **src/components/base/** — папка с базовым кодом (инфраструктура)
    
-   **src/components/models/** — папка с моделями данных (Model)
    

**Важные файлы:**

-   `index.html` — HTML-файл главной страницы
    
-   `src/types/index.ts` — файл с типами и интерфейсами
    
-   `src/main.ts` — точка входа приложения, выполняющая роль Презентера
    
-   `src/scss/styles.scss` — корневой файл стилей
    
-   `src/utils/constants.ts` — файл с константами (API_URL, CDN_URL)
    
-   `src/utils/utils.ts` — файл с утилитами
    

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды:

Bash

```
npm install
npm run dev

```

Или с использованием yarn:

Bash

```
yarn
yarn dev

```

## Сборка

Bash

```
npm run build

```

----------

# Архитектура приложения

Код приложения разделен на слои согласно парадигме **MVP (Model-View-Presenter)**, что обеспечивает четкое разделение ответственности между данными, интерфейсом и логикой.

-   **Model**: Слой данных, отвечает за хранение, изменение и валидацию данных.
    
-   **View**: Слой представления, отвечает за отображение данных на странице и уведомление о действиях пользователя.
    
-   **Presenter**: Связующее звено, которое подписывается на события View и обновляет Model, или наоборот. Роль Презентера выполняет файл `src/main.ts`.
    

Взаимодействие между классами реализовано через **событийно-ориентированный подход** с использованием брокера событий (`EventEmitter`).

----------

## 1. Базовый код (Base)

### Класс Component<T>

Абстрактный базовый класс для всех компонентов интерфейса. Предоставляет инструментарий для работы с DOM.

-   **`constructor(container: HTMLElement)`** — инициализирует компонент, сохраняя ссылку на контейнер.
    
-   **`render(data?: Partial<T>): HTMLElement`** — основной метод, который обновляет свойства компонента через сеттеры и возвращает корневой элемент.
    
-   **`setText(element: HTMLElement, value: unknown)`** — устанавливает текстовое содержимое элемента.
    
-   **`setImage(element: HTMLImageElement, src: string, alt?: string)`** — устанавливает путь и альтернативный текст для изображений.
    
-   **`setVisible / setHidden`** — управляет отображением элементов.
    

### Класс Api

Обеспечивает взаимодействие с сервером по протоколу HTTP.

-   **`get(uri: string)`** — выполняет GET-запрос и возвращает промис с ответом.
    
-   **`post(uri: string, data: object, method: ApiPostMethods = 'POST')`** — отправляет данные на сервер в формате JSON.
    
-   **`handleResponse(response: Response)`** — обрабатывает ответ сервера, проверяя его на корректность.
    

### Класс EventEmitter

Брокер событий, реализующий паттерн "Наблюдатель". Позволяет слоям приложения общаться без жесткой привязки друг к другу.

-   **`on`** — подписка на событие.
    
-   **`emit`** — инициация события с передачей данных.
    
-   **`trigger`** — возвращает функцию, которая генерирует событие при вызове (удобно для событий в DOM).
    

----------

## 2. Модели данных (Model)

### ProductsModel

Хранит каталог товаров и управляет выбранным товаром.

-   `setItems(items: IProduct[])` — обновляет список всех товаров.
    
-   `getProduct(id: string)` — поиск товара по его идентификатору.
    
-   `setSelected(item: IProduct)` — устанавливает товар, который будет открыт в модальном окне.
    

### BasketModel

Отвечает за состояние корзины покупок.

-   `addItem(item: IProduct)` — добавляет товар в корзину (проверяя наличие цены).
    
-   `removeItem(id: string)` — удаляет товар из списка покупок.
    
-   `getTotal()` — рассчитывает суммарную стоимость всех товаров.
    
-   `clear()` — очищает корзину (например, после успешного заказа).
    

### BuyerModel

Хранит данные покупателя и отвечает за их валидацию.

-   `setData(data: Partial<IBuyer>)` — обновляет информацию (email, телефон, адрес, способ оплаты).
    
-   `validate()` — проверяет корректность данных и возвращает объект с описанием ошибок.
    

----------

## 3. Слой представления (View)

Компоненты View наследуются от `Component` и используют события для связи с Презентером.

-   **Page**: Управляет отображением всей страницы, включая счетчик корзины и сетку товаров. Имеет метод для блокировки прокрутки (при открытии модальных окон).
    
-   **Modal**: Универсальное модальное окно. Принимает любой контент (`content`) и управляет своим состоянием (открыто/закрыто).
    
-   **Card**: Компонент карточки товара. Имеет три состояния: в каталоге, превью в модальном окне и элемент в корзине.
    
-   **Form**: Базовый компонент для форм. Управляет активностью кнопки отправки и отображением ошибок валидации.
    
-   **Basket**: Компонент корзины, отображает список выбранных товаров и общую сумму.
    

----------

## 4. Слой коммуникации (API)

### Класс LarekApi

Расширяет базовый `Api` для специфики проекта «Web-Larёk».

-   **`getProducts(): Promise<IProduct[]>`** — получает список товаров и трансформирует пути к изображениям, добавляя префикс CDN.
    
-   **`postOrder(order: IOrder): Promise<IOrderResult>`** — отправляет данные сформированного заказа на сервер.
    

----------

## Данные и типы

Основные сущности описаны интерфейсами:

-   `IProduct` — ID, название, описание, категория, цена, изображение.
    
-   `IBuyer` — данные клиента (оплата, email, телефон, адрес).
    
-   `IOrder` — объект заказа (данные покупателя + массив ID товаров + сумма).